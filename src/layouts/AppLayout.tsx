import Head from "next/head";
import styles from '@styles/applayout.module.sass'
import BottomBar from "@/components/BottomBar";
import Sidebar from "@/components/Sidebar";
import { useState } from 'react'
import Loading from "@/components/Loading";
import { useObserver } from "@/hooks/useObserver";
import AccountSettings from "@/components/Bottombar/AccountSettings";

export default function AppLayout({children, setSettings, settings, toggles, setIsSetup, isSetup}: any){
  const [windows, setWindows] = useState({
    settings: false,
    account: false
  })
  const [userData, setUserData] = useState({
    accountName: 'NewMinesweeper',
    experience: 0,
    xpNeeded: 100,
    xpLeft: 0,
    lvl: 0,
    image: ''
  })

  const setters = {setWindows, toggles, setSettings, setIsSetup, setUserData}
  const getters = {windows, settings, userData}
  const observer = useObserver(userData, "userData", true)

  return(
    <>
      <Head>
        <title>Minesweeper Online</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
      </Head>
      {isSetup ? <Loading setters={setters} getters={getters}/> : <></>}
      {settings.background ? <div className={styles.background}/> : <></>}
      <div className={styles.content}>
        <Sidebar
          setters={setters}
          getters={getters}/>
        {children}
        <AccountSettings
          getters={getters} 
          setters={setters}/>
        <BottomBar
          setters={setters}
          getters={getters}/>
      </div>
    </>
  )
}